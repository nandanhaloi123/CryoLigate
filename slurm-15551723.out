/home/x_nanha/.conda/envs/CryoLigate/lib/python3.9/site-packages/timm/models/layers/__init__.py:49: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
wandb: [wandb.login()] Loaded credentials for https://api.wandb.ai from /home/x_nanha/.netrc.
wandb: Currently logged in as: nandanhaloi123 (nandanhaloi123-kth-royal-institute-of-technology) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run 1y4p0guf
wandb: Tracking run with wandb version 0.24.2
wandb: Run data is saved locally in /proj/berzelius-2022-haloi/users/x_nanha/CryoLigate/wandb/run-20260213_160135-1y4p0guf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run run_20260213_160133_ROI_FUNDAMENTAL_no_aug
wandb: â­ï¸ View project at https://wandb.ai/nandanhaloi123-kth-royal-institute-of-technology/cryoem-ligand-fitting
wandb: ðŸš€ View run at https://wandb.ai/nandanhaloi123-kth-royal-institute-of-technology/cryoem-ligand-fitting/runs/1y4p0guf
--- Training run_20260213_160133_ROI_FUNDAMENTAL_no_aug on cuda ---
--- Loss Config: Dice=0.5, ROI_MSE=10.0, Global=0.1 ---
Loading dataset...
Initializing SCUNet...
wandb: WARNING Saving files without folders. If you want to preserve subdirectories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
wandb: WARNING Symlinked 1 file into the W&B run directory; call wandb.save again to sync new files.
Epoch 001 | Val Loss: 4.03918 | Ligand MSE: 0.37360 | Dice: 0.538
   >>> New Best Ligand MSE! (0.37360) Saving weights...
Epoch 002 | Val Loss: 3.70142 | Ligand MSE: 0.34498 | Dice: 0.620
   >>> New Best Ligand MSE! (0.34498) Saving weights...
Epoch 003 | Val Loss: 3.55640 | Ligand MSE: 0.33257 | Dice: 0.649
   >>> New Best Ligand MSE! (0.33257) Saving weights...
Epoch 004 | Val Loss: 3.55011 | Ligand MSE: 0.33432 | Dice: 0.690
Epoch 005 | Val Loss: 3.54447 | Ligand MSE: 0.33452 | Dice: 0.703
Epoch 006 | Val Loss: 3.71465 | Ligand MSE: 0.35377 | Dice: 0.739
Epoch 007 | Val Loss: 3.84899 | Ligand MSE: 0.36818 | Dice: 0.757
Epoch 008 | Val Loss: 3.78925 | Ligand MSE: 0.36243 | Dice: 0.758
Epoch 009 | Val Loss: 3.75851 | Ligand MSE: 0.35971 | Dice: 0.765
Epoch 010 | Val Loss: 3.81297 | Ligand MSE: 0.36642 | Dice: 0.785
Epoch 011 | Val Loss: 3.63078 | Ligand MSE: 0.34808 | Dice: 0.781
Epoch 012 | Val Loss: 3.62164 | Ligand MSE: 0.34814 | Dice: 0.796
Epoch 013 | Val Loss: 3.64626 | Ligand MSE: 0.35137 | Dice: 0.807
Epoch 014 | Val Loss: 3.58219 | Ligand MSE: 0.34544 | Dice: 0.815
Epoch 015 | Val Loss: 3.56751 | Ligand MSE: 0.34458 | Dice: 0.824
Epoch 016 | Val Loss: 3.63384 | Ligand MSE: 0.35196 | Dice: 0.835
Epoch 017 | Val Loss: 3.60516 | Ligand MSE: 0.34969 | Dice: 0.844
Epoch 018 | Val Loss: 3.58223 | Ligand MSE: 0.34768 | Dice: 0.848
Epoch 019 | Val Loss: 3.55043 | Ligand MSE: 0.34499 | Dice: 0.856
Epoch 020 | Val Loss: 3.60926 | Ligand MSE: 0.35152 | Dice: 0.865
Epoch 021 | Val Loss: 3.56931 | Ligand MSE: 0.34786 | Dice: 0.870
Epoch 022 | Val Loss: 3.65564 | Ligand MSE: 0.35711 | Dice: 0.879
Epoch 023 | Val Loss: 3.55963 | Ligand MSE: 0.34765 | Dice: 0.881
Epoch 024 | Val Loss: 3.61833 | Ligand MSE: 0.35392 | Dice: 0.887
Epoch 025 | Val Loss: 3.58027 | Ligand MSE: 0.35030 | Dice: 0.890
Epoch 026 | Val Loss: 3.61301 | Ligand MSE: 0.35384 | Dice: 0.894
Epoch 027 | Val Loss: 3.65298 | Ligand MSE: 0.35812 | Dice: 0.898
Epoch 028 | Val Loss: 3.62666 | Ligand MSE: 0.35565 | Dice: 0.900
Epoch 029 | Val Loss: 3.65774 | Ligand MSE: 0.35893 | Dice: 0.903
Epoch 030 | Val Loss: 3.63164 | Ligand MSE: 0.35644 | Dice: 0.904
Epoch 031 | Val Loss: 3.65497 | Ligand MSE: 0.35892 | Dice: 0.906
Epoch 032 | Val Loss: 3.63285 | Ligand MSE: 0.35678 | Dice: 0.907
Epoch 033 | Val Loss: 3.66486 | Ligand MSE: 0.36013 | Dice: 0.910
Epoch 034 | Val Loss: 3.68374 | Ligand MSE: 0.36213 | Dice: 0.911
Epoch 035 | Val Loss: 3.64912 | Ligand MSE: 0.35869 | Dice: 0.912
Epoch 036 | Val Loss: 3.69602 | Ligand MSE: 0.36351 | Dice: 0.913
Epoch 037 | Val Loss: 3.72412 | Ligand MSE: 0.36638 | Dice: 0.914
Epoch 038 | Val Loss: 3.69989 | Ligand MSE: 0.36399 | Dice: 0.915
Epoch 039 | Val Loss: 3.73289 | Ligand MSE: 0.36737 | Dice: 0.916
Epoch 040 | Val Loss: 3.71523 | Ligand MSE: 0.36562 | Dice: 0.916
Epoch 041 | Val Loss: 3.72065 | Ligand MSE: 0.36622 | Dice: 0.917
Epoch 042 | Val Loss: 3.72662 | Ligand MSE: 0.36685 | Dice: 0.917
Epoch 043 | Val Loss: 3.73770 | Ligand MSE: 0.36800 | Dice: 0.918
Epoch 044 | Val Loss: 3.74016 | Ligand MSE: 0.36826 | Dice: 0.918
Epoch 045 | Val Loss: 3.73350 | Ligand MSE: 0.36761 | Dice: 0.918
Epoch 046 | Val Loss: 3.74340 | Ligand MSE: 0.36864 | Dice: 0.919
Epoch 047 | Val Loss: 3.75099 | Ligand MSE: 0.36942 | Dice: 0.919
Epoch 048 | Val Loss: 3.75963 | Ligand MSE: 0.37030 | Dice: 0.919
Epoch 049 | Val Loss: 3.76243 | Ligand MSE: 0.37060 | Dice: 0.920
Epoch 050 | Val Loss: 3.76235 | Ligand MSE: 0.37060 | Dice: 0.920
Epoch 051 | Val Loss: 3.76492 | Ligand MSE: 0.37087 | Dice: 0.920
Epoch 052 | Val Loss: 3.76064 | Ligand MSE: 0.37045 | Dice: 0.920
Epoch 053 | Val Loss: 3.76116 | Ligand MSE: 0.37052 | Dice: 0.920
Epoch 054 | Val Loss: 3.76901 | Ligand MSE: 0.37131 | Dice: 0.920
Epoch 055 | Val Loss: 3.76932 | Ligand MSE: 0.37135 | Dice: 0.921
Epoch 056 | Val Loss: 3.76572 | Ligand MSE: 0.37099 | Dice: 0.921
Epoch 057 | Val Loss: 3.76718 | Ligand MSE: 0.37114 | Dice: 0.921
Epoch 058 | Val Loss: 3.76664 | Ligand MSE: 0.37109 | Dice: 0.921
Epoch 059 | Val Loss: 3.76650 | Ligand MSE: 0.37108 | Dice: 0.921
wandb: updating run metadata
wandb: uploading history steps 59-59, summary, console lines 68-72
wandb: 
wandb: Run history:
wandb:       dice â–â–‚â–„â–„â–…â–…â–†â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:      epoch â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb: masked_mse â–ˆâ–ƒâ–â–â–…â–†â–†â–‡â–„â–„â–ƒâ–„â–„â–ƒâ–„â–…â–…â–…â–…â–…â–…â–†â–…â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb: train_loss â–ˆâ–…â–„â–ƒâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:   val_loss â–ˆâ–â–â–ƒâ–…â–„â–…â–‚â–‚â–‚â–â–‚â–‚â–â–‚â–â–‚â–‚â–ƒâ–‚â–‚â–‚â–ƒâ–ƒâ–„â–„â–ƒâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„
wandb: 
wandb: Run summary:
wandb:       dice 0.92088
wandb:      epoch 59
wandb: masked_mse 0.3714
wandb: train_loss 0.05837
wandb:   val_loss 3.76963
wandb: 
wandb: ðŸš€ View run run_20260213_160133_ROI_FUNDAMENTAL_no_aug at: https://wandb.ai/nandanhaloi123-kth-royal-institute-of-technology/cryoem-ligand-fitting/runs/1y4p0guf
wandb: â­ï¸ View project at: https://wandb.ai/nandanhaloi123-kth-royal-institute-of-technology/cryoem-ligand-fitting
wandb: Synced 8 W&B file(s), 0 media file(s), 0 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20260213_160135-1y4p0guf/logs
Epoch 060 | Val Loss: 3.76963 | Ligand MSE: 0.37140 | Dice: 0.921

--- Training Ended. Finalizing... ---
--- Loading Best Model Weights from /proj/berzelius-2022-haloi/users/x_nanha/CryoLigate/results/run_20260213_160133_ROI_FUNDAMENTAL_no_aug/best_model.pth ---
   >>> Generating 5 MRC samples for inspection...
--- Done. Check results in /proj/berzelius-2022-haloi/users/x_nanha/CryoLigate/results/run_20260213_160133_ROI_FUNDAMENTAL_no_aug ---
